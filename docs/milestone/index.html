<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<style>
  body {
    padding: 100px;
    width: 1000px;
    margin: auto;
    text-align: left;
    font-weight: 300;
    font-family: 'Open Sans', sans-serif;
    color: #121212;
  }
  h1, h2, h3, h4 {
    font-family: 'Source Sans Pro', sans-serif;
  }
</style>
<title>CS 184 Final Project</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link href="https://fonts.googleapis.com/css?family=Open+Sans|Source+Sans+Pro" rel="stylesheet">
</head>


<body>

    <h1 align="middle">CS 184: Computer Graphics and Imaging, Spring 2022</h1>
    <h1 align="middle">Final Project: Bubble Ring Simulation </h1> 
    <h2 align="middle">Ryu Akiba, Marco Gellecanao, Srinivasan Madhavan, Aditya Prasad</h2>
    <hr />
    <div>
        <h1 align="left">Milestone Status Report</h1>
        <p>
            We lay out the progress we have made in the first two weeks of the project.
        </p>
        <iframe width="600" height="400"
                            src="https://www.youtube.com/embed/mf75uNi8fEw">
        </iframe>
        <p>
            Presentation Link: 
            <a href=
            "https://docs.google.com/presentation/d/1VK7BjovRcQ2ftuPQmr7JTT5c8VEv9UtBY7WoyquQ1vY/edit?usp=sharing">
              https://docs.google.com/presentation/d/1VK7BjovRcQ2ftuPQmr7JTT5c8VEv9UtBY7WoyquQ1vY/edit?usp=sharing</a>
        </p>
        <br />
        <h2 align="left">1: Understanding Bubble Ring Physics</h2>
        <p>
            The fluid mechanics and vortex dynamics behind the evolution of bubble rings
            are quite complex and intriguing. Padilla et al., 2019 develop a simulation
            method for bubble rings and ink chandeliers by looking at the dynamics of vortex
            filaments. In this seciton, Ryu, the resident applied math/fluid mechanics person,
            will attempt to describe the physics and numerical algorithms presented by the paper.
            For a complete description, the readers are encouraged to read the paper,
            "On Bubble Rings and Ink Chandeliers" by Padilla et al., 2019.
        </p>

        <h3 align="left">1.1: The Bubble Ring</h3>
        <div align="center">
            <table style="width=100%">
                <tr>
                    <td align="middle">
                        <img src="images/filament_diagram.png" width="480px" />
                        <figcaption align="middle">Bubble Ring Diagram (Fig 6 Padilla, et al. 2019)</figcaption>
                    </td>

                </tr>
            </table>
        </div>
        <p>
            The bubble ring is repreesnted as a vortex filament, which is comprised of a closed center
            curve &gamma; in &#8477;<sup>3</sup> and a thickness <i>a</i> along the curve. This curve
            can be discretized and represented as a polygon. The vertices of the polygon carry
            position information, and the edges have length, direction (which is tangent to the curve), and
            thickness data. At a high level, the equations of motion are applied to the vertices to
            evolve them in time, and different equations are applied to model the air flow through the
            bubble ring based on the new positions, updating the thickness.
        </p>

        <h3 align="left">1.2: Equations of Motion</h3>
        <p>
            A bubble ring underwater experiences a buoyant force pushing it to the surface. In addition,
            there are lift forces from the fluid motion generated by the vortex, forces from thickness
            variations in the bubble ring, and dissipation. For a bubble ring, the buoyancy force
            is estimated by an Atwood number of -1 times gravity, thus it points up towards the
            water surface as expected.
        </p>
        <div align="center">
            <table style="width=100%">
                <tr>
                    <td align="middle">
                        <img src="images/equation18.png" width="700px" />
                        <figcaption align="middle">Velocity Equation (Eq. 18 modified from Padilla, et al. 2019)</figcaption>
                    </td>
                </tr>
            </table>
        </div>
        <p>
            The equations of motion eventually collapse into a first order differential equation for
            the velocity at each vertex for curve &gamma; given by Eq. 18 in Padilla et al., 2019 shown above
            in a modified form. Circulation <i>C</i>, Atwood number <i>At</i> = -1, kinematic viscosity
            &nu; = 1e-6 m<sup>2</sup>/s are given, and <i>a</i> is the thickness associated with a vertex.
            The velocity of vertex <i>v</i><sub>i</sub> is computed in three parts:
            Biot-Savart velocity, localized induction, and Boussinesq term. Then, the position of the
            vertex is evolved in time using a Runge-Kutta 4th order integrator.
        </p>

        <h3 align="left">1.3: Thickness Flow</h3>
        <div align="center">
            <table style="width=100%">
                <tr>
                    <td align="middle">
                        <img src="images/equation27.png" width="300px" />
                        <figcaption align="middle">Burgers's Equation in backward Euler form (Eq. 27 modified from Padilla, et al. 2019)</figcaption>
                    </td>
                </tr>
            </table>
        </div>
        <p>
            After an update in position, the thickness of the bubble ring allowed to change according to
            Burgers's Equation rearranged into Eq. 27 in Padilla et al., 2019 for a backward Euler scheme.
            Here, the flux of air within the bubble ring is calculated, and the thickness along the ring is
            updated in time.
        </p>

        <h3 align="left">1.4: Bubble Ring Splitting and Reconnection</h3>
        <p>
            The splitting and reconnection of bubble rings can also be modeled through a method of
            Weissmann and Pinkall, 2010. A criterion over pairs of curve segments can be computed to
            split or combine two vortex filaments. Implementation of this feature is a reach goal
            for this project.
        </p>

        <h3 align="left">1.5: Implementation in Python</h3>
        <div align="center">
            <table style="width=100%">
                <tr>
                    <td align="middle">
                        <img src="images/bubble_ring_py.png" width="600px" />
                        <figcaption align="middle">Sample evolution of bubble ring using Python implementation</figcaption>
                    </td>
                </tr>
            </table>
        </div>
        <p>
            An initial implementation of the physics has been attempted in Python closely following Padilla, et al. 2019
            and referencing the sample code provided by the authors in the SideFX Houdini physics engine. A resulting single bubble
            ring propagation is shown in the figure above. We observe the expanding of the bubble ring radius and
            thinning of the ring (not shown) as it rises. Some issues of numerical stability, especially in the thickness flow
            remain to be resolved.
        </p>

        <div align="center">
            <table style="width=100%">
                <tr>
                    <td align="middle">
                        <img src="images/python_code_functions.png" width="600px" />
                        <figcaption align="middle">Python implementation of velocity computations</figcaption>
                    </td>
                </tr>
            </table>
        </div>

        <p>
            The velocity described in section 1.2 is implemented in this Python code snippet. The three terms of the
            velocity Eq. 18 are given by the functions <code>biotsavartedge</code>, <code>induction</code>, and
            <code>boussinesq</code> respectively. These functions take vertex positions and associated thicknesses
            and circulations as inputs and output the terms of the velocity equation. The summing is done in the
            <code>velocity</code> function. The Boussinesq term (Term 3) is computed differently in that it is first
            computed over the edges of the bubble ring filament, then it is interpolated to the vertices.
        </p>

        <div align="center">
            <table style="width=100%">
                <tr>
                    <td align="middle">
                        <img src="images/python_code_rk4.png" width="600px" />
                        <figcaption align="middle">Runge-Kutta 4th order integration</figcaption>
                    </td>
                </tr>
            </table>
        </div>

        <p>
            The velocity found above is used within a Runge-Kutta 4th order integration scheme laid out in the above
            Python code. The four terms of RK4 are computed with partial updates of the position <code>pos_RK</code>,
            then the terms are used with RK4 weights to update the main position array <code>pos</code>. In the process,
            some thickness modifications are done to reflect the partial updates in position.
        </p>

        <div align="center">
            <table style="width=100%">
                <tr>
                    <td align="middle">
                        <img src="images/python_code_burgers.png" width="600px" />
                        <figcaption align="middle">Burgers's equation thickness flow code</figcaption>
                    </td>
                </tr>
            </table>
        </div>

        <p>
            Implementation of Burgers's equation and a backwards Euler integration scheme is currently in progress.
            The method of using sparse matrices was taken from the paper provided Houdini code. However,
            there seems to be numerical issues when using many vertices for the filament which still needs to be resolved.
        </p>
    
        <h2 align="left">2: Simulation and Shading</h2>
        <h3 align="left">2.1: Simulation</h3>
        <p>
            We are using Project 4: Cloth Sim as our starting point for the final project, since it implements a simulation that
            already incorporates point masses and springs which act between the point masses. We have modified the <code>Cloth</code> 
            class to a <code>Filament</code> class (aka a bubble ring) whose shape is defined by a vector of <code>Edges</code> and has a
            <code>circulation</code> field, which is important for the velocity computations described above. We also have modified the
            <code>Spring</code> class to an <code>Edge</code> class, which represents a segment of the bubble ring and has a thickness 
            associated with it which is again used in the velocity computations above. Also, the <code>Spring</code> class no longer
            applies forces to the point masses (stiffness is 0) because we are computing the forces through the above equations, so the
            functionality is solely as an edge. Finally, we have added a <code>thickness</code> field to the <code>PointMass</code> class
            as well, which is defined as the average of the <code>thickness</code>es of the two adjacent edges.
        </p>
        <h3 align="left">2.2: Shading</h3>
        <p>
            Shading is an ongoing investigation. We are going to implement a new shading technique as we did in Project 4 to attempt to
            photorealistically render the bubble ring during simulation. One approach we have seen is compounding displacement mapping with
            a sinusoidal time-dependent function to create ripples on the object, as if the object was submerged underwater with waves
            above it.
        </p>

        <h2 align="left">2: Reflection</h2>
        <p>
            Our progess so far has aligned with our schedule. We have looked into the paper we are implementing, found Project 4 as a
            starting point and modified its objects to support our work, and have a working demo of the simulation of a bubble ring over time,
            for now in Python. We are getting close to a working simulation in C++, and from there we will create and apply a shader for
            photorealistic simulation. Finally, if we have time, we will implement bubble ring collision.
        </p>
    </div>
</body>

</html>
